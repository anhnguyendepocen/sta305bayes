---
title: "Exercice 6 : Méta-analyse bayésienne"
linktitle: "Exercice 6 :  Méta-analyse bayésienne"
date: "2020-11-30"
read_date: "2020-12-09"
menu:
  practicals:
    parent: "TP"
    weight: 6
type: docs
output:
  blogdown::html_page:
    toc: false
    number_sections: false
bibliography: "../../static/bib/references.bib"
csl: "../../static/bib/chicago-syllabus-no-bib.csl"
---



<p>Méta-analyse bayésienne</p>
<p>En 2014, Crins <em>et al.</em> ont publiés une méta-analyse pour évaluer l’incidence des rejets aigu (RA) avec ou sans traitement avec récepteurs antagonistes à l’Interleukin-2. Dans cet exercice nous allons recréer cette analyse.</p>
<ol start="0" style="list-style-type: decimal">
<li><p>Charger le package <code>R</code> <code>bayesmeta</code> <span class="citation">Christian Röver, “Bayesian Random-Effects Meta-Analysis Using the Bayesmeta R Package,” <em>arXiv Preprint 1711.08683</em> (2017), <a href="http://www.arxiv.org/abs/1711.08683" role="doc-biblioref">http://www.arxiv.org/abs/1711.08683</a>.</span> et les données de <span class="citation">Nicola D Crins et al., “Interleukin-2 Receptor Antagonists for Pediatric Liver Transplant Recipients: A Systematic Review and Meta-Analysis of Controlled Studies,” <em>Pediatric Transplantation</em> 18, no. 8 (2014): 839–850, doi:<a href="https://doi.org/10.1111/petr.12362" role="doc-biblioref">10.1111/petr.12362</a>.</span> avec la commande <code>R</code>:</p>
<pre class="r"><code>library(bayesmeta)
data(CrinsEtAl2014)</code></pre></li>
<li><p>Explorer l’application <em>web</em> <code>shiny</code> accompagnant le <em>package</em> et disponible à l’adresse : <a href="http://ams.med.uni-goettingen.de:3838/bayesmeta/app/" class="uri">http://ams.med.uni-goettingen.de:3838/bayesmeta/app/</a>. Charger les données de Crins <em>et al.</em> correspondant au rejet aigu,étudier et commenter les sorties et résultats, essayer différentes loi <em>a priori</em>, etc.</p></li>
<li><p>Maintenant depuis <code>R</code>, avec la fonction <code>escalc()</code> du package <code>metafor</code>, calculer les <em>log odds ratios</em> estimés à partir des 6 études considérées avec les variances d’échantillonnage associées (<strong>ProTip :</strong> lire la section <em>Measures for Dichotomous Variables</em> de l’aide de la fonction <code>escalc()</code>). Vérifier la cohérence avec l’application <code>shiny</code> en ligne (<strong>NB :</strong> <code>sigma</code> est l’écart-type, i.e. la racine carré de la variance d’échantillonnage <code>vi</code>)</p>
<pre class="r"><code>library(&quot;metafor&quot;)
crins.es &lt;- escalc(measure = &quot;OR&quot;, ai = exp.AR.events, n1i = exp.total, ci = cont.AR.events, 
    n2i = cont.total, slab = publication, data = CrinsEtAl2014)
crins.es[, c(&quot;publication&quot;, &quot;yi&quot;, &quot;vi&quot;)]</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">publication</th>
<th align="right">yi</th>
<th align="right">vi</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Heffron (2003)</td>
<td align="right">-2.3097026</td>
<td align="right">0.3593718</td>
</tr>
<tr class="even">
<td align="left">Gibelli (2004)</td>
<td align="right">-0.4595323</td>
<td align="right">0.3095760</td>
</tr>
<tr class="odd">
<td align="left">Schuller (2005)</td>
<td align="right">-2.3025851</td>
<td align="right">0.7750000</td>
</tr>
<tr class="even">
<td align="left">Ganschow (2005)</td>
<td align="right">-1.7578579</td>
<td align="right">0.2078161</td>
</tr>
<tr class="odd">
<td align="left">Spada (2006)</td>
<td align="right">-1.2584610</td>
<td align="right">0.4121591</td>
</tr>
<tr class="even">
<td align="left">Gras (2008)</td>
<td align="right">-2.4178959</td>
<td align="right">2.3372623</td>
</tr>
</tbody>
</table>
<p><strong>NB</strong> Les <em>log-OR</em> (<em>odds ratios</em>) sont symmétriques autour de zéros et leur distribution d’échantillonnage est plus proche d’une distribution Gaussienne que dans l’échelle narturelle des <em>OR</em>. C’est pourquoi ils sont généralement préférés dans le cadre des méta-analyses. Leur variances d’échantillonnage sont calculées comme la somme de l’inverse de tous les comptes dans le tableau de contingence <span class="math inline">\(2 \times 2\)</span> associé.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a><br />
On aurait pu également utiliser des <em>log-RR</em> (<em>risk ratios</em>) afin de se rapprocher de l’analyse faite par Crins <em>et al.</em> en spécifiant <code>measure="RR"</code> dans la fonction <code>escalc()</code>, mais ce n’est pas ce qui est fait dans l’application shiny implémentant <code>bayesmeta</code><a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p></li>
</ol>
<ol start="3" style="list-style-type: decimal">
<li><p>Effectuer une méta-analyse avec un effet-aléatoire sur ces données avec la fonction <code>bayesmeta()</code> du package <code>R</code> <code>bayesmeta</code>, depuis le logiciel <code>R</code>. Utiliser une loi <em>a priori</em> uniforme sur <span class="math inline">\([0,4]\)</span> pour <span class="math inline">\(\tau\)</span> (la précision) et une loi <em>a priori</em> Gaussienne centrée autour de <span class="math inline">\(0\)</span> et avec un écart-type de 4 pour <span class="math inline">\(\mu\)</span> la moyenne.</p></li>
<li><p>Écrire le modèle Bayésien correspondant à cette méta-analyse à effet aléatoire (mathématiquement, sans utilisé <code>R</code> — pour le moment).</p></li>
<li><p>Utiliser <code>rjags</code> pour estimer ce même modèle, en enregistrant le model écrit en <code>BUGS</code> dans un fichier <code>.txt</code> (nommé <code>crinsBUGSmodel.txt</code> par exemple). Commenter vos résultats.</p></li>
</ol>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><span class="citation">Joseph L. Fleiss and Jesse A. Berlin, “Effect Sizes for Dichotomous Data,” in <em>The Handbook of Research Synthesis and Meta-Analysis, 2nd Ed</em> (New York, NY, US: Russell Sage Foundation, 2009), 237–253.</span><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><span class="citation">Jonathan J. Deeks, “Issues in the Selection of a Summary Statistic for Meta-Analysis of Clinical Trials with Binary Outcomes,” <em>Statistics in Medicine</em> 21, no. 11 (2002): 1575–1600, doi:<a href="https://doi.org/https://doi.org/10.1002/sim.1188" role="doc-biblioref">https://doi.org/10.1002/sim.1188</a>.</span><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
